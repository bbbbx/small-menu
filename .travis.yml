language: node_js
node_js:
  - "9"
services:
  - mysql
addons:
  apt:
    update: true
before_install:
  - sudo mysql -e "use mysql; update user set authentication_string=PASSWORD('root') where User='root'; update user set plugin='mysql_native_password'; FLUSH PRIVILEGES;"
  - sudo mysql_upgrade --force
  - sudo service mysql restart
  - sudo mysql -e 'CREATE DATABASE IF NOT EXISTS test;'
  - sudo mysql -e "CREATE DATABASE IF NOT EXISTS smallmenu DEFAULT CHARSET utf8mb4 COLLATE utf8mb4_general_ci;"
  - sudo mysql -e "use mysql; SELECT host, user, authentication_string FROM user;"
install:
  - npm install
script:
  - npm start